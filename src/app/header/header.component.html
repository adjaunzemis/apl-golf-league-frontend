<p-card>
  <p-menubar [model]="items">
    <ng-template #start>
      <p-image src="assets/apl_golf_logo.png" alt="APL Golf League" routerLink="/" />
    </ng-template>

    <ng-template #item let-item>
      <ng-container *ngIf="item.visible && item.route; else urlRef">
        <a [routerLink]="item.route" class="p-menubar-item-link">
          <span [class]="item.icon"></span>
          <span>{{ item.label }}</span>
        </a>
      </ng-container>
      <ng-template #urlRef>
        <a
          *ngIf="item.visible && item.url; else callback"
          [href]="item.url"
          class="p-menubar-item-link"
        >
          <span [class]="item.icon"></span>
          <span>{{ item.label }}</span>
        </a>
      </ng-template>
      <ng-template #callback>
        <button
          *ngIf="item.visible && item.callback; else noLink"
          (click)="item.callback()"
          class="p-menubar-item-link"
        >
          <span [class]="item.icon"></span>
          <span>{{ item.label }}</span>
        </button>
      </ng-template>
      <ng-template #noLink>
        <div *ngIf="item.visible" class="p-menubar-item-link">
          <span [class]="item.icon"></span>
          <span>{{ item.label }}</span>
          <span class="pi pi-fw pi-angle-down"></span>
        </div>
      </ng-template>
    </ng-template>

    <ng-template *ngIf="!maintenance" #end>
      <div class="flex flex-row items-center ml-4">
        <p-select
          class="ring-1 ring-gray-300 text-center h-8 pl-2 py-1 mr-4"
          [options]="seasons"
          [(ngModel)]="selectedSeason"
          optionLabel="year"
          placeholder="Season"
          (onChange)="onSelectedYearChanged($event)"
        >
          <ng-template #selectedItem let-selectedOption>
            <div class="flex items-center gap-2" *ngIf="selectedOption">
              <span>{{ selectedOption.year }}</span>
              <p-tag
                class="text-sm font-normal px-1"
                [ngClass]="selectedOption.is_active ? 'season-active' : 'season-complete'"
                value="{{ selectedOption.is_active ? 'Active' : 'Complete' }}"
              />
            </div>
          </ng-template>
          <ng-template let-option #item>
            <div class="flex items-center gap-2">
              <span>{{ option.year }}</span>
              <p-tag
                class="text-sm font-normal px-1"
                [ngClass]="option.is_active ? 'season-active' : 'season-complete'"
                value="{{ option.is_active ? 'Active' : 'Complete' }}"
              />
            </div>
          </ng-template>
        </p-select>

        <ng-container *ngIf="isAuthenticated; else loginRef">
          <!-- TODO: Add profile page here? Routerlink: /auth/user -->

          <button (click)="onLogout()" class="p-menubar-item-link">
            <span class="pi pi-sign-out"></span>
            <span>Logout</span>
          </button>
        </ng-container>

        <ng-template #loginRef>
          <a routerLink="/auth/login" class="p-menubar-item-link">
            <span class="pi pi-sign-in"></span>
            <span>Login</span>
          </a>
        </ng-template>
      </div>
    </ng-template>
  </p-menubar>
</p-card>
